# 데이터 사이언스 교과서

## 1. 확률이란
확률(probability)이란 수식으로 나타내는 비율이다.  
```
기대하는 사건(event)이 일어나는 경우의 수 / 발생할 가능성이 있는 모든 경우의 수 
```
표본공간(sample space)이란 시행(trial)의 결과로서 생기는 실현값 전체의 집합이다.  
실현값은 표본공간의 한 점이기 때문에 표본점(sample point)이라고 한다.  
확률 변수(random variable, 랜덤변수)란 표본공간을 수치화한 것으로 확률적으로 정한 변수이다.  
확률분포(probability theory)란 확률 변수 각각의 값에 대한 확률의 형태(형상이라고 생각해도 된다)를 말한다.

## 2. 기본적인 용어 정리
### 2.1 이산확률 변수

X = {x1, x2, ..., xn} = {xi}  
<br>
이산확률 변수의 확률분포는 P(X = xi) = pi 로 나타낸다.  
또한 확률의 공리에 의해, 전체 확률의 총합은 1이 된다. 즉  
```
Σ P(X = xi) = p1 + p2 + ... = 1
```

### 2.2 연속확률 변수
이산확률 변수에서는 집합 X의 각 요소에 대해서 확률이 주어져 있다. 한편, 연속확률 변수에서는 집합의 각 요소에 대한 확률은 0, P(X=x) = 0이다.

1) 실수축 x의 어느 구간 [a, b] 내의 한 점이라고 생각하고 이 확률을 1로 하고 높이로 비유하기로 한다.  
2) 한 점을 두 점으로 분배하고 균등하게 절반씩 나누는 것으로 한다.  
3) 이 분배를 무한히 반복하면 구간 [a, b] 내의 선분이 그려진다.  
이 선분을 구성하는 무한개의 점 각각에 대한 확률은 극한을 생각하기 때문에 0이 되지만 처음의 정의에 의해 확률의 모든 합은 1이 된다. 
4) 또한 확률이 0이라고 해도, 이것은 극단적인 경우에 0이므로 사건이 일어나는 일도 있다. 이것이 연속확률 변수의 특징이다.

연속확률 변수의 이용 용도는 어떤 사람이 은행의 ATM 앞에 선 시간부터 떠날 때까지의 이용시가늘 생각할 때에 이용된다.  
시간이 확률 변수일 때 '이용시간은 1분 15초'라는 식으로 시간을 딱 맞춰 가리키는 것이 불가능하고 '몇 분 이내'라는 식을 시간의 폭, 즉 구간을 지정해야 한다.  
이 이유는 1~2분 구간에는 이산점으로 표현되는 시간이 무수히 존재하기 때문이다.  
따라서 몇 천, 몇 만 자리 정밀도의 디지털 시계라고 하더라도 이 구간 내의 이산점 모두를 엄밀하게 표현할 수는 없다.  
이 떄문에 정확하게 '이용 시간은 1분 15초'(정확하다는 것은 이 뒤에 0이 무한히 계속되는 것)가 되는 확률은 0이라는 것을 이해해야한다.  
이에 비해 구간으로 지정되면 이용 시간을 연속확률 변수로 취급할 수 있다.  

### 2.3 확률밀도 함수, 확률질량 함수와 백분위점

이산확률 변수의 분포를 그림으로 그리면 이산점이 나타나고 그 총합은 1이라고 약속한다. 이 분포를 나타내는 함수를 **확률질량 함수**(pmf: probability mass function) f(x)라고 한다.  
연속확률 변수의 분포를 그림으로 나타내면 매끄러운 곡선이 나타나고, 그 전체 면적은 1이라고 약속한다. 이 분포를 나타내는 함수를 **확률밀도 함수**(pdf: probability desity function) f(x)라고 한다.  

여기에서 f(x)는 양쪽 공통이지만 문맥에서 어떤 것인가를 판단하면 된다. 또한 이산, 연속으로 용어를 구분해서 사용하는 것이 번잡할 때는 확률분포라고 총칭하는 경우가 있다.

확률분포와 확률 P(X)와의 관계를 기술한다. 이산형의 경우 확률은 f(xi) = P(X=xi)가 되는 것에 유의하고 어느 범위의 확률은 다음의 덧셈 형태가 된다.
```
P(X <= x) = Σ f(X)
           X<=x
```
연속형의 경우 구간 [a, b]의 확률은 다음 식으로 표현된다. 이것은 구간[a, b]에서 f(x)의 면적과 같다.
```
                  b
P(a <= X <= b) = ∫ f(x)dx
                a
```
이 사이의 차이는 덧셈을 하는 것과 면적을 구하는 것에 있다.

**백분위점**(percentage point)에 관해서는 확률밀도 함수(연속형)를 이용하여 설명한다. 이산형확률 변수의 경우에도 거의 동일한 이론을 적용할 수 있다.  
백분위점 Za는 그 점보다 위쪽의 확률이 a(또는 100a%)가 되는 점을 말한다. 분포 함수에 따라 이 값은 다르고, 또한 분포가 대칭이 아닌 경우도 있다. 표준정규분포 N(0,1)의 경우는 약 Za = 1.645가 된다.

양측의 경우 즉 백분위점이 아래쪽과 위쪽의 [za, zb]로 주어지고 이 구간의 확률을 구하는 방법은 P(x <= zb)의 확률을 pb, P(x <= za)의 확률은 pa라고 할 때 구하려는 확률 = pb - pa로 구해진다.

양쪽 표의 왼쪽 열은 SciPy의 표기, 오른쪽 열은 그 확률 분포의 이름을 나타내나. 확률 분포를 기초로 몇 가지 계산을 SciPy가 담당한다.
```
                                이산확률 분표
                    bernoulli | Bernoulli distribution
                    binom     | Binomial distribution
                    poisson   | Poisson distribution

                                연속확률 분포
                    chi2      | Chi-squared(X^2) distribution
                    f         | F distribution
                    norm      | Normal distribution
                    t         | Student's t distribution
                    uniform   | Uniform distribution
```

### 2.4 모집단과 표본
**모집단**(population)이란 조사대상이 되는 집단 전체를 말하고 모집단의 특성을 나타내는 값을 모수(parameter)라고 한다.  
확률론, 통계학의 세계에서는 파라미터(parameter)라고 부르는 방식보다는 모수라는 용어를 이용하는 경우가 많다. 또한 모집단의 특성을 확률분포로 나타내는 경우에는 모수는 그 확률분포를 특정짓는 값을 말한다.

예를 들면, 평균 λ인 포아송분포라든가, 평균 µ, 분산 σ2인 정규분포처럼 평균이나 분산을 가리킨다.

### 2.5 평균, 분산, 그 외의 양
**평균**(mean), **분산**(variance), **표준편차**(standard derivation), **공분산**(convariance) 등의 정의 제시 및 이산확률 변수, 연속확률 변수에 대해서 각각 정의.

*이산확률 변수의 경우*
```
       N
E[X] = ∑ xi*pi = µ
      i=1

       N
V[X] = ∑ (xi - µ)^2 * pi = σ2
      i=1
```
- E[-]는 기댓값(expected value)을 구하는 연산자이다.  
- V[-]는 분산(variance)을 구하는 연산자이다.  
- 두 가지 연산자 모두 '[]'을 이용하는 이유는 이산값과 연속값에서 연산 내용이 다르다는 점을 강조하고 싶은 것뿐으로 다른 이유X  
- 표준편차는 분산의 제곱근 σ(시그마)로 나타낸다.
- 개수 N은 전체 사건수(또는 전체 요소수)를 나타내고, µ, σ2은 실제 모수를 나타낸다. N이 전체 사건수보다 작은 표본수라면 통계량이 된다.

공분산은 두 개의 확률 변수 X, Y에 대해서 다음과 같이 계산된다.
```
C[X, Y] = E[(X - E[X])(Y - E[Y])] = E[XY] - E[X]E[Y] --- 식 3.9
```


*연속확률 변수의 경우*
확률 변수 X의 확률밀도 함수를 f(x)라고 할 때 평균, 분산은 각각 다음 식으로 정의된다.
```
            +∞
E[X] = µ = ∫ xf(x)dx
          -∞

                               +∞
V[X] = σ2 = E[(X - E[X])^2] = ∫ (x - µ)^2f(x)dx
                             -∞
```
표준편차는 σ이다. 또한 공분산은 식 3.9와 동일한 정의.

### 2.6 이산형의 기댓갑과 평균
기댓값 = (확률 변수 X 해당 값을 갖는 확률) 의 총합 = (상금(a) X 당첨확률(b))의 총합  
확률이 동일한 경우에는 기댓값이 평균값이 된다.

---
---

## 3. 정규분포
### 3.1 정규분포의 표현
**정규분포**(normal distribution)는 확률,통계학에서 가장 유용한 연속형 확률분포 함수이다.  
정규분포는 평균값을 중심으로 좌우대칭 분포의 모양을 나타낸다.  
전체 면적 = 1의 조건 아래에서 다음과 같은 성질이 있다.  
- σ2-> 대: x의 산포도가 크다(그래프의 높이->낮다, 폭->넓다)
- σ2-> 소: x의 산포도가 작다(그래프의 높이->높다, 폭->좁다)

확률 변수x가 정규분포를 따르는 변수라는 것을 나타내는 표현은 다음과 같다.  
x ~ N(µ, σ2)

표준정규분포(standard normal distribution)는 통계의 검정 등에서 사용되는 것으로 정규분포를 따르는 x를 다음과 같이 변환한다. 이 변환된 z는 평균값 0, 분산 1인 정규분포가 된다.

z = (x - µ) / σ ~ N(0, 1)

원래의 x가 존재하는 구간이 [a, b]일 때 표준정규분포로 변환된 z의 구간은 다음과 같다.  
[a, b] -> [(a - µ) / σ, (b - µ) / σ]  
이 때 P(a <= x <= b)는 위의 변환된 구간에서의 z의 면적과 동일하다.

scipy.stats.norm은 정규분포에 관한 몇 가지 계산을 수행한다.
- norm.ppf(percent point function, 백분위점 함수) a가 주어지고 확률 (1-a)가 되는 백분위점(단측)을 구한다.
- norm.isf(inverse survival function, 역생존 함수) norm.ppf의 (1-a)를 계산하지 않고, 직접 a로부터 백분위점을 구한다.
- norm.interval 구간[za, zb], (|za| = zb)의 확률(1-a)가 주어지고 백분위점 za, zb를 구한다.
- norm.cdf(cumulative density function, 누적분포 함수) 백분위점이 주어지고 이 확률을 구한다.
- norm.pdf(probability desity function, 확률 함수) 확률 변수 x가 주어지고 확률밀도 함수 f(x)의 값을 구한다.
- norm.rvs(random variables) 평균값 loc, 표준편차 scale, 크기 size의 랜덤 변수를 발생시킨다.  

[실습 practice1]()

### 3.2 확률 변수의 생성
인공적으로 확률 변수 생성  
[실습 practice2]()

### 3.3 중심극한정리
중심극한정리(central limit theorem)  
표본 x1, x2, ..., xn이 독립이고 기댓값이 µ, 표준편차 σ인 어떤 확률분포를 따른다고 한다. 표본 평균은  
```
^
µ = (x1 + x2 + .. + xn) / n
```
이라고 한다(표본평균은 새로운 확률 변수가 되는 것에 유의하자). 표본의 크기 n이 커짐에 따라 표본평균은 평균 µ, 표준편차 σ / n^0.5 정규분포에 가까워 진다. 다만 n이 커짐에 따라 분포의 폭이 좁아지는 것에 주의한다.
```
z = (표본평균 - µ) / (σ/n*0.5)
```
이것은 n이 커짐에 따라 표준정규분포 N(0, 1)에 가까워진다.

이 정리는 모집단의 확률분포가 어떠한 것이라도, n이 충분히 크다면, 표본분포는 정규분포 N(µ, σ2/n)을 따른다고 간주하면 된다는 것을 기술한다. 이것이 정규분포가 자주 이용되는 이유 중의 하나이다.  
[실습 practice3]()