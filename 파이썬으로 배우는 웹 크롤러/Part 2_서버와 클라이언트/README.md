# 파이썬으로 배우는 웹 크롤러
### #크롤러를 만들만들기 위해 필요한 지식
    * 클라이언트
    * 서버
    * 웹 브라우저의 작동방식

크롤러는 웹에 대해 상당히 의존적, 수집하고자 하는 웹사이트에 따라 만드는 방식이 다름.

---
### 1. 클라이언트
- 데이터, 서비스를 요청하는 프로그램
- 요청한 데이터를 사용자에게 보여주는 역할
- 웹 브라우저도 하나의 클라이언트 프로그램
---
### 2. 서버
- 인터넷을 통해 연결된 클라이언트에 (정적인)데이터 또는 서비스를 제공하는 프로그램
- 서버가 없다면 클라이언트는 존재X
- 상당히 추상적인 개념으로 서비스를 만든 개발자만이 어떻게 만들어 졌는지 정확하게 앎  

    => 이러한 서버를 어떤 구조로 만들었는지 파악하고 유추하는 것이 굉장히 중요  
    => 서버에게 응답받는 데이터를 찾고, 그 데이터를 서버에서 어떻게 가져오는지 판단하는 과정이 중요

\*www (world wide web) - 초기에 문서 공유를 위해 만들어진 것

---
### 2-1. 서버의 종류
1. 영상 -   
영상 서버의 경우 다른 서버와 다르게 데이터를 한 번에 주는 것이 아니라 일정량 분할하여 전송, 이것을 **스트리밍**이라고 함  
영상을 한 번에 받는다면 부담되기 때문에 스트리밍 방식을 많이 사용

2. 파일 -  
과거 파일을 제공하는 서비스 중 대표적인 것 - P2P  
오늘 날에는 토렌트, 각종 드라이브를 사용. 이러한 것도 서버의 한 종류  
FTP, SFTP를 이용하여 개인이 파일 서버를 구축하기도 함

3. 채팅 및 음성 -  
메신저 - 채팅을 제공하는 프로그램. 메신저 프로그램도 서버가 없으면 절대 동작할 수 없음.

4. 도메인 -  
인터넷을 통해 www.domain.com과 같은 형태로 인터넷 사용.  
이러한 문자로 된 것은 IP라고 하는 주소로 대응되어 있음.  
도메인 주소에 대해 대응되는 IP를 알려주는 것을 DNS(Domain Name Survice)

5. 게임 -  
게임 서버를 통해 인터넷을 연결하여 마치 한 공간에 있는 것처럼 표현.  
채팅 서버와 구조가 비슷함. 채팅은 대화 내용을 전달하게 되고 게임 서버는 서로의 위치 정보를 주고 받음

6. 웹 -  
웹 브라우저를 통해 요청된 페이지를 받아오는 서버  
서버는 웹을 정적 페이지, 동적 페이지와 같은 형태로 제공 

\***정리**  
서버는 특정 데이터만 제공하는 것이 아니라 상황에 맞춰 다양한 데이터를 제공

---
### 3. 서버와 클라이언트가 데이터를 주고받는 방법
\*프로토콜 - 서버와 데이터가 데이터를 주고받는 규약

---
### 3-1. 요청 메소드
CRUD - Create, Read, Update, Delete 클라이언트가 서버에 데이터를 요청할 때 쓰는 네 가지 타입 

실제로 클라이언트는 CRUD로 직접 명시하지 않고 요청 헤더에  
GET, POST, PUT, DELETE의 형태로 메소드를 정의. 아래과 같이 매핑  
- GET : Read  
클라이언트가 서버에 데이터를 요청할 때 사용하는 메소드. 서버의 종류에 따라 다양한 데이터를 요청

- POST : Create  
특정 데이터를 추가하는 요청. 데이터를 만들어 내는 것. 즉, DB에 데이터를 추가한다는 의미

- PUT : Update  
특정 데이터에 대해 수정하라는 요청. DB에 존재하는 데이터를 수정.

- DELETE : Delete  
특정 데이터를 삭제하라는 의미. DB에 존재하는 데이터를 삭제.

\***정리**   
데이터를 요청할 때 데이터를 요청하는 형태에 따라 메소드를 달리 함.  
데이터를 요청할 때 GET 요청만 할 필요 없으며, POST, PUT, DELETE로 해도 큰 상관은 없음  

실제 사이트에선 GET과 POST를 이용하여 데이터를 요청.  
이 외에도 상당히 많은 메소드가 존재하지만 거의 사용하지 않고, 이 중에서도 GET과 POST 요청을 주로 사용  

크롤러는 데이터를 가져오는 것이 관심 사항이기 때문에 데이터를 수정하고 삭제하는 PUT, DELETE 메소드는 신경 쓰지 않음

---

### 3-2. 응답 코드
서버가 클라이언트 요청을 처리하고 난 후 상태에 따라 반환하는 코드

1. 1xx 조건부 응답 -  
클라이언트가 데이터를 일부만 포함해 보내어 서버가 데이터를 더 보내라고 하는 응답 코드.  
100, 101, 102를 제공하지만 1xx는 사용하지 않아야 함.

2. 2xx 성공 -  
서버가 클라이언트로부터의 요청을 성공적으로 처리한 후 반환하는 응답 코드.  

    - 200 - 서버가 클라이언트의 요청을 성공적으로 처리. 웹 페이지에서는 페이지 요청이 정상적으로 완료되면 200 코드 반환.  

    - 201 - 서버가 요청된 클라이언트의 정보를 정상적으로 저장. POST 요청으로 데이터 저장 요청 시 잘 저장됐다면 201 코드 반환.

    - 202 - 요청 접수만 되고 아직 처리되지 않은 상태. 서버는 현재의 상태를 보여주는 페이지를 제공해 주어야 함.

    - 203 - 정보를 신뢰할 수 없는 경우.

    - 204 - 클라이언트로 반환되는 데이터가 없을 때. 즉, 빈 콘텐츠 제공

    - 205 - 서버는 요청을 성공적으로 처리. 반환되는 콘텐츠가 비어있을 경우 클라이언트로부터 재설정시키는 코드

    - 206 - 일부 콘텐츠

    - 207 - 다중 상태

    - 208 - 이미 보고됨  

    많이 사용되는 응답 코드는 200, 201, 204번

3. 3xx 새로고침 완료  
클라이언트가 요청을 완료하기 위해서 작업이 남아있는 코드. 보통 새로고침을 한 경우 반환하는 응답 코드.

    - 300 - 여러 선택 항목
    - 301 - 영구 이동
    - 302 - 임시 이동
    - 303 - 기타 위치 보기
    - 304 - 수정되지 않음
    - 305 - 프록시 사용
    - 307 - 임시 새로고침
    - 308 - 영구 새로고침

    많이 사용되는 응답 코드는 301, 302, 303, 304, 307

4. 4xx 요청 오류(매우 많아서 중요한 코드만 기록)  
클라리언트의 요청이 잘못됐을 때 반환하는 응답 코드. 즉, 문제 발생 원인이 클라이언트에게 있음.

    - 400 - 잘못 요청
    - 401 - 권한 없음. 예로 로그인 페이지가 필요한 페이지를 로그인 없이 접속하려는 경우 반환되는 코드
    - 403 - 금지됨. 예로 로그인된 사용자 관리자 페이지로 접속하려고 시도하는데 관리자가 아닌 경우 반환되는 코드
    - 404 - 찾을 수 없음. 흔히 보이는 코드로 존재하지 않는 URL을 요청하여 페이지를 접속할 수 없을 때 반환하는 응답 코드.
    - 405 - 잘못된 요청 메소드 사용

5. 5xx 서버 오류(많아서 중요한 코드만 기록)  
서버의 설정, 코드 등의 문제로 오류가 났을 때 반환되는 코드

    - 500 - 내부 서버 오류. 보통 서버 코드의 문제 시 반환되는 응답 코드
    - 502 - 불량 게이트웨이(웹 서버를 게이트웨이라고 부르기도 함)
    - 503 - 서비스를 사용할 수 없음
    - 504 - 게이트웨이 시간 초과
    - 505 - http 버전이 지원되지 않음. 이 경우 https 사용

---
### 3-3. 헤더
서버와 클라이언트 간 데이터를 주고 받을 때, 헤더라는 정보를 포함하여 보낸다.  
이때 헤더는 서버와 클라이언트의 정보를 포함하고 있는 것.  

- Request Header - 클라이언트가 서버에 데이터를 요청할 때 포함된 헤더  

    문서와 구성 형태 및 형식을 포함

\* Response Header - 서버가 클라이언트에게 응답할 때 포함된 헤더  
\* General Header - 서버와 클라이언트 양측 모두에게 사용되는 일반적인 정보가 포함된 헤더  
\* Entity Header - 메시지에 대한 설명을 포함하는 헤더